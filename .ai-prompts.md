# Identify code that can be factorized in a common function

I want you to review the code and tell me if there is some code in the 3 `query.lua` files that can be factorized in a common function.
If there is some code that can be factorized, provide me the refactored code with the common function.
Tell me the full new contents of the files I need to create and modify.
